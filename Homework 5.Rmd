---
title: "Homework 5"
author: "Dania Jafar"
date: "11/2/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
```

```{r Problem 1}

replace_missing = function(x) {
  if (is.numeric(x)){ 
    x = replace_na(x, mean(x, na.rm = TRUE))}
   else if (is.character(x)) {
     x = replace_na(x,"virginica")}
  }
 
fixed_iris = map(iris_with_missing, replace_missing) %>% 
  as_tibble() 
```

```{r Problem 2}

files = list.files(path = "./data", pattern = NULL, all.files = FALSE,
           full.names = FALSE, recursive = FALSE,
           ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)

data = data_frame(file_name = files) %>% 
    mutate(file_contents = map(file_name, ~read_csv(file.path("./data", .)))) %>%
  unnest() %>% 
pivot_longer(week_1:week_8, names_to = "week",
   values_to = "measurement") %>% 
  separate(file_name, sep = ".c", into = c("file_name", "remove")) %>% select(-remove) %>% 
  separate(file_name, into = c("group", "subject_id"), sep = "_") %>% 
  mutate(
    group = recode(group,
         `con` = "control",
         `exp` = "experimental")
    )

```

